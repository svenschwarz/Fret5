<div id="FretBoard">
    <div class="key-line">
        <label>Key:&nbsp;</label>
        <span class="button" data-bind="click: previousKey">&lt;</span>
        <span data-bind="text: key().name" style="display: inline-block; width: 34px; text-align: center;" />
        <span class="button" data-bind="click: nextKey">&gt;</span>
        &nbsp;
        <span class="button" data-bind="text: '(' + keyTypeName() + ')', click: toggleKeyType" />

        <div class="button" style="position: absolute; right: 8px;" title="Click to remove this fret board"
             data-bind="click: $root.removeThisFretBoard" >
            [x]
        </div>

    </div>
    <br/>

    <div data-bind="template: { name: 'T_FretTable', data: table }"
         style="width: 100%; height: 230px; overflow-x: auto; overflow-y: visible;" />
    <br/>

    <table>
        <tr data-bind="template: { name: 'T_MarkedNotes', data: 0, as: 'colorNumber' }" />
        <tr data-bind="template: { name: 'T_MarkedNotes', data: 1, as: 'colorNumber' }" />
        <tr data-bind="template: { name: 'T_MarkedNotes', data: 2, as: 'colorNumber' }" />
    </table>

    <br/>
    <hr style="width: 100%;" />
    <br/>
</div>



<script type="text/html" id="T_FretTable">
    <div class="g-table">
        <div class="g-tr" data-bind="template: { name: 'T_FretTableHeaderCell', foreach: $data[0] }" />
        <div class="g-tr" data-bind="template: { name: 'T_FretTableCell', foreach: $data[0] }" />
        <div class="g-tr" data-bind="template: { name: 'T_FretTableCell', foreach: $data[1] }" />
        <div class="g-tr" data-bind="template: { name: 'T_FretTableCell', foreach: $data[2] }" />
        <div class="g-tr" data-bind="template: { name: 'T_FretTableCell', foreach: $data[3] }" />
        <div class="g-tr" data-bind="template: { name: 'T_FretTableCell', foreach: $data[4] }" />
        <div class="g-tr" data-bind="template: { name: 'T_FretTableCell', foreach: $data[5] }" />
    </div>
</script>


<script type="text/html" id="T_FretTableHeaderCell">
    <div class="g-th">
        <!-- ko if: $data.fret > 0 -->
        <div class="fret-in-table" data-bind="text: $data.fret" />
        <!-- /ko -->
    </div>
</script>


<script type="text/html" id="T_FretTableCell">
    <div class="g-td" data-bind="click: $root.clickOnCell.bind($root, $data)">
        <!-- ko if: $root.key().contains($data.note) -->
        <div class="note-in-table" data-bind="text: $data.name" />
        <!-- /ko -->

        <!-- ko if: $data.fret > 0 -->
        <div class="string-line"></div>
        <!-- /ko -->

        <!-- ko if: ($data.fret == 3 && $data.string == 2) || ($data.fret == 5 && $data.string == 2) || ($data.fret == 7 && $data.string == 2) || ($data.fret == 9 && $data.string == 2) || ($data.fret == 12 && ($data.string == 0 || $data.string == 4))  ||  ($data.fret == 15 && $data.string == 2) || ($data.fret == 17 && $data.string == 2) || ($data.fret == 19 && $data.string == 2) || ($data.fret == 21 && $data.string == 2) -->
        <div class="neck-dot" />
        <!-- /ko -->

        <!-- ko if: $data.ismarked1 || $data.ismarked2 || $data.ismarked3 -->
        <div class="markerarea-in-table">
            <span data-bind="css: {'marker3-in-table': $data.ismarked3, 'nomarker-in-table': !$data.ismarked3}">&nbsp;</span>
            <span data-bind="css: {'marker2-in-table': $data.ismarked2, 'nomarker-in-table': !$data.ismarked2}">&nbsp;</span>
            <span data-bind="css: {'marker1-in-table': $data.ismarked1, 'nomarker-in-table': !$data.ismarked1}">&nbsp;</span>
        </div>
        <!-- /ko -->
    </div>
</script>


<script type="text/html" id="T_MarkedNotes">
    <td data-bind="click: $root.selectColor.bind($root, colorNumber),
                    css: { selected: $root.selectedColor() == colorNumber,
                           'marked1-in-line': colorNumber == 0,
                           'marked2-in-line': colorNumber == 1,
                           'marked3-in-line': colorNumber == 2 }">

        <span data-bind="foreach: $root.markedNotesArray()[colorNumber]">
            <span class="note-in-line" data-bind="text: $data.name" />
        </span>

    </td>
    <td data-bind="click: $root.selectColor.bind($root, colorNumber),
                    css: { selected: $root.selectedColor() == colorNumber,
                           'marked1-in-line': colorNumber == 0,
                           'marked2-in-line': colorNumber == 1,
                           'marked3-in-line': colorNumber == 2 }">

        <span data-bind="foreach: { data: $root.matchingChordsArray()[colorNumber], as: 'chord'}">
            <label data-bind="text: chord.name, click: $root.setChord.bind($root, colorNumber, chord)"
                   class="button" style="padding-left: 20px;" />
        </span>

        <span class="button" data-bind="click: $root.enterChord.bind($root, colorNumber)" style="padding-left: 10px;">
            Q
        </span>

    </td>

</script>

